<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ä¹ ç«™</title>
    <link rel="stylesheet" type="text/css" href="index.css">
</head>

<body>
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="header">
        <nav>
            <a href="/">é¦–é¡µ</a>
            <a href="/discover">å‘ç°</a>
            <div class="search-bar">
                <input type="text" placeholder="æœç´¢ç¬”è®°/ç”¨æˆ·">
            </div>
            <a href="/profile">ä¸ªäººä¸­å¿ƒ</a>
        </nav>
    </header>

    <!-- å†…å®¹ä¸»ä½“ -->
    <main class="content-grid">
        <!-- å•ç¯‡ç¬”è®°ç¤ºä¾‹ -->
        <article class="note-card">

            <div class="note-info">
                <h3>ç¬”è®°æ ‡é¢˜</h3>
                <p>ç¬”è®°å†…å®¹æ‘˜è¦...</p>
                <div class="interactions">
                    <span>â¤ï¸ ç‚¹èµæ•°</span>
                    <span>ğŸ’¬ è¯„è®ºæ•°</span>
                </div>
            </div>
        </article>
        <!-- æ›´å¤šç¬”è®°å¡ç‰‡... -->

    </main>

    <!-- åº•éƒ¨å‘å¸ƒæŒ‰é’® -->
    <div class="floating-button">
        <a href="https://github.com/lastsuperboy/lastsuperboy.github.io/issues/new?template=note_submission.md"
            target="_blank">
            + å‘å¸ƒç¬”è®°
        </a>
    </div>

    <!-- åœ¨</body>å‰æ·»åŠ  -->
    <script>
        // GitHubä»“åº“ä¿¡æ¯é…ç½®
        const REPO_OWNER = 'lastsuperboy';
        const REPO_NAME = 'lastsuperboy.github.io';

        // è·å–issuesçš„API URL
        const API_URL = `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues`;

        // ç¬”è®°å®¹å™¨
        const contentGrid = document.querySelector('.content-grid');

        // è·å–å¹¶æ¸²æŸ“issues
        async function loadNotes() {
            try {
                const response = await fetch(API_URL);
                const issues = await response.json();

                // æ¸…ç©ºç¤ºä¾‹å†…å®¹
                contentGrid.innerHTML = '';

                issues.forEach(issue => {
                    contentGrid.appendChild(createNoteCard(issue));
                });
            } catch (error) {
                console.error('Error loading notes:', error);
                contentGrid.innerHTML = '<p>ğŸ˜¢ ç¬”è®°åŠ è½½å¤±è´¥ï¼Œè¯·ç¨ååˆ·æ–°é‡è¯•</p>';
            }
        }

        // åˆ›å»ºç¬”è®°å¡ç‰‡
        function createNoteCard(issue) {
            const card = document.createElement('article');
            card.className = 'note-card';

            card.innerHTML = `
        <div class="note-info">
            <h3>${escapeHtml(issue.title)}</h3>
            <div class="content-preview">
                ${truncateText(escapeHtml(issue.body), 200)}
            </div>
            <div class="interactions">
                <span>ğŸ“… ${formatDate(issue.created_at)}</span>
                <span>ğŸ’¬ ${issue.comments}</span>
                <span>ğŸ‘ï¸ ${issue.reactions?.eyes || 0}</span>
            </div>
        </div>
    `;
            card.addEventListener('click', () => {
                window.open(issue.html_url, '_blank'); // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
            });
            card.addEventListener('mousedown', () => {
                card.style.transform = 'scale(0.98)';
            });

            card.addEventListener('mouseup', () => {
                card.style.transform = 'scale(1)';
            });

            // æ·»åŠ è§¦æ‘¸äº‹ä»¶æ”¯æŒ
            let tapTimer;
            card.addEventListener('touchstart', () => {
                tapTimer = setTimeout(() => {
                    card.style.transform = 'scale(0.98)';
                }, 50);
            });

            card.addEventListener('touchend', () => {
                clearTimeout(tapTimer);
                card.style.transform = 'scale(1)';
            });

            return card;
        }



        // è¾…åŠ©å‡½æ•°
        function getFirstImage(text) {
            const imgMatch = text.match(/!\[.*?\]\((.*?)\)/);
            return imgMatch ? imgMatch[1] : 'default-cover.jpg';
        }

        function escapeHtml(text) {
            return text.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }

        function truncateText(text, maxLength) {
            return text.length > maxLength ? text.slice(0, maxLength) + '...' : text;
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('zh-CN');
        }

        // åˆå§‹åŒ–åŠ è½½
        loadNotes();
    </script>

</body>

</html>
